(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ffdb22c2","chunk-a27e1820","chunk-2d22dbd3"],{"0654":function(t,e,a){},"15f1":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n(a("11cd"));function n(t){return t&&t.__esModule?t:{default:t}}function r(t){t.addEventListener("mousedown",d)}function o(t){t.removeEventListener("mousedown",d)}function i(t){var e=document.createElement("span");e.className="p-ink",t.appendChild(e),e.addEventListener("animationend",c)}function u(t){var e=l(t);e&&(o(t),e.removeEventListener("animationend",c),e.remove())}function d(t){var e=t.currentTarget,a=l(e);if(a&&"none"!==getComputedStyle(a,null).display){if(s.default.removeClass(a,"p-ink-active"),!s.default.getHeight(a)&&!s.default.getWidth(a)){var n=Math.max(s.default.getOuterWidth(e),s.default.getOuterHeight(e));a.style.height=n+"px",a.style.width=n+"px"}var r=s.default.getOffset(e),o=t.pageX-r.left+document.body.scrollTop-s.default.getWidth(a)/2,i=t.pageY-r.top+document.body.scrollLeft-s.default.getHeight(a)/2;a.style.top=i+"px",a.style.left=o+"px",s.default.addClass(a,"p-ink-active")}}function c(t){s.default.removeClass(t.currentTarget,"p-ink-active")}function l(t){for(var e=0;e<t.children.length;e++)if("string"===typeof t.children[e].className&&-1!==t.children[e].className.indexOf("p-ink"))return t.children[e];return null}var m={inserted:function(t,e,a){a.context.$primevue&&a.context.$primevue.config.ripple&&(i(t),r(t))},unbind:function(t){u(t)}},_=m;e.default=_},"34ab":function(t,e,a){"use strict";a("0654")},"7b36":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("article",{staticClass:"handbook-list"},[t.userEducationForm?a("div",{staticClass:"handbook__item form"},[t._v(" "+t._s(t.userEducationForm.form.name)+" ")]):t._e(),t._l(t.statuses,(function(e){return a("div",{key:e.id,staticClass:"handbook__item status"},[t._v(" "+t._s(e.status[t.statusLabel])+" ")])})),t.isEditable||t.isShowOnly?a("div",{staticClass:"handbook__item status",style:{cursor:"pointer"},on:{click:function(e){return e.stopPropagation(),t.openPopup(e)}}},[a("Icon",{attrs:{name:"crossBold"}})],1):t._e(),t.statusToDelete.status?a("AcceptPopup",{attrs:{title:t.statusToDelete.title,"action-label":t.statusToDelete.actionLabel},on:{accept:t.deleteUserStatus,close:t.closeConfirmModal}}):t.isOpenPopup?a("ModalWindow",{on:{close:t.closePopup},scopedSlots:t._u([{key:"default",fn:function(){return[t.isLoading?a("Spinner",{attrs:{fixed:!0}}):t._e()]},proxy:!0},{key:"header",fn:function(){return[a("div",{staticClass:"handbook__header"},[a("Icon",{attrs:{name:"management"}}),a("div",{staticClass:"handbook__header-info"},[a("h1",{staticClass:"handbook__title"},[t._v(" "+t._s(t.$t("title"))+" ")])])],1)]},proxy:!0},{key:"body",fn:function(){return[a("h3",{staticClass:"handbook__education-title"},[t._v(" "+t._s(t.$t("educationForm"))+" ")]),t._l(t.allUserForms,(function(e){return a("div",{key:e.id,staticClass:"handbook__form-item"},[a("Icon",{staticClass:"p-mb-2",attrs:{name:"basket"},on:{click:function(a){return t.removeEducationForm(e.id)}}}),a("div",{staticClass:"handbook__form-header"},[a("div",{staticClass:"handbook__form-controls"},[e.created_at?a("span",{staticClass:"handbook__form-item__updated"},[t._v(" "+t._s(t.normalizeDate(e.created_at))+" ")]):t._e()]),e.owner?a("div",{staticClass:"handbook__form-item__owner"},[a("Avatar",{attrs:{user:e.owner}}),a("span",{staticClass:"handbook__item__owner"},[t._v(t._s(t.userFullName(e.owner)))])],1):t._e()]),a("label",{staticClass:"dropdown-label"},[t._v(" "+t._s(t.$t("educationFormTitle"))+" ")]),a("PDropdown",{staticClass:"handbook__dropdown",attrs:{options:t.isShowOnly?[{id:e.education_form_id,name:e.form.name}]:t.educationForms,"option-label":"name","option-value":"id",disabled:t.isShowOnly},model:{value:e.education_form_id,callback:function(a){t.$set(e,"education_form_id",a)},expression:"form.education_form_id"}}),a("label",{staticClass:"required-label"},[t._v(" "+t._s(t.$t("requiredField"))+" ")]),a("div",{staticClass:"status__range"},[a("div",{staticClass:"handbook__calendar-wrapper"},[a("label",{staticClass:"dropdown-label"},[t._v(" "+t._s(t.$t("startDate"))+" ")]),a("PCalendar",{staticClass:"handbook__calendar",attrs:{"date-format":"dd.mm.yy","select-other-months":!0,placeholder:"__.__.____",disabled:t.isShowOnly},model:{value:e.start_date,callback:function(a){t.$set(e,"start_date",a)},expression:"form.start_date"}}),a("label",{staticClass:"required-label"},[t._v(" "+t._s(t.$t("notRequiredField"))+" ")])],1),a("div",{staticClass:"handbook__calendar-wrapper"},[a("label",{staticClass:"dropdown-label"},[t._v(" "+t._s(t.$t("endDate"))+" ")]),a("PCalendar",{staticClass:"handbook__calendar",attrs:{"date-format":"dd.mm.yy","select-other-months":!0,placeholder:"__.__.____",disabled:t.isShowOnly},model:{value:e.end_date,callback:function(a){t.$set(e,"end_date",a)},expression:"form.end_date"}}),a("label",{staticClass:"required-label"},[t._v(" "+t._s(t.$t("notRequiredField"))+" ")])],1)])],1)})),t.isCanAddEducationForm?a("Icon",{attrs:{name:"circlePlus"},on:{click:t.addEducationForm}}):t._e(),a("hr",{staticClass:"handbook__split"}),a("h3",{staticClass:"handbook__education-title"},[t._v(" "+t._s(t.$t("temporaryStatus"))+" ")]),t._l(t.allUserStatuses,(function(e){return a("div",{key:e.id,staticClass:"handbook__form-item"},[a("div",{staticClass:"handbook__form-header"},[a("div",{staticClass:"handbook__form-controls"},[a("span",{staticClass:"handbook__form-item__updated"},[t._v(" "+t._s(t.normalizeDate(e.created_at))+" ")]),t.isShowOnly?t._e():a("div",{staticClass:"p-d-flex p-align-center"},[a("Icon",{attrs:{name:"basket"},on:{click:function(a){return t.confirmDeleteUserStatus(e)}}}),t.statusesToEdit.some((function(t){return t.id===e.id}))?a("Icon",{staticClass:"p-ml-2",attrs:{name:"cross"},on:{click:function(a){return t.removeStatusFromEdit(e)}}}):a("Icon",{staticClass:"p-ml-2",attrs:{name:"pencil"},on:{click:function(a){return t.addStatusToEdit(e)}}})],1)]),a("div",{staticClass:"handbook__form-item__owner"},[a("Avatar",{attrs:{user:e.owner}}),a("span",{staticClass:"handbook__item__owner"},[t._v(t._s(t.userFullName(e.owner)))])],1)]),a("label",{staticClass:"dropdown-label"},[t._v(" "+t._s(t.$t("temporaryStatusTitle"))+" ")]),a("PDropdown",{staticClass:"handbook__dropdown",attrs:{options:t.isShowOnly?[{id:e.temporary_status_id,name:e.status.name}]:t.temporaryStatuses,"option-label":"name","option-value":"id",disabled:!t.statusesToEdit.some((function(t){return t.id===e.id}))||t.isShowOnly},model:{value:e.temporary_status_id,callback:function(a){t.$set(e,"temporary_status_id",a)},expression:"status.temporary_status_id"}}),a("label",{staticClass:"required-label"},[t._v(" "+t._s(t.$t("requiredField"))+" ")]),a("div",{staticClass:"status__range"},[a("div",{staticClass:"handbook__calendar-wrapper"},[a("label",{staticClass:"dropdown-label"},[t._v(" "+t._s(t.$t("startDate"))+" ")]),a("PCalendar",{staticClass:"handbook__calendar",attrs:{"date-format":"dd.mm.yy","select-other-months":!0,disabled:!t.statusesToEdit.some((function(t){return t.id===e.id}))||t.isShowOnly},model:{value:e.start_date,callback:function(a){t.$set(e,"start_date",a)},expression:"status.start_date"}}),a("label",{staticClass:"required-label"},[t._v(" "+t._s(t.$t("requiredField"))+" ")])],1),a("div",{staticClass:"handbook__calendar-wrapper"},[a("label",{staticClass:"dropdown-label"},[t._v(" "+t._s(t.$t("endDate"))+" ")]),a("PCalendar",{staticClass:"handbook__calendar",attrs:{"date-format":"dd.mm.yy","select-other-months":!0,placeholder:"__.__.____",disabled:!t.statusesToEdit.some((function(t){return t.id===e.id}))||t.isShowOnly},model:{value:e.end_date,callback:function(a){t.$set(e,"end_date",a)},expression:"status.end_date"}}),a("label",{staticClass:"required-label"},[t._v(" "+t._s(t.$t("notRequiredField"))+" ")])],1)])],1)})),t._l(t.statusesToAdd,(function(e,s){return a("div",{key:e.number,staticClass:"handbook__form-item"},[a("Icon",{attrs:{name:"basket"},on:{click:function(e){return t.removeStatusToAdd(s)}}}),a("label",{staticClass:"dropdown-label"},[t._v(" "+t._s(t.$t("temporaryStatusTitle"))+" ")]),a("PDropdown",{staticClass:"handbook__dropdown",attrs:{options:t.temporaryStatuses,"option-label":"name","option-value":"id"},model:{value:e.id,callback:function(a){t.$set(e,"id",a)},expression:"status.id"}}),a("label",{staticClass:"required-label"},[t._v(" "+t._s(t.$t("requiredField"))+" ")]),a("div",{staticClass:"status__range"},[a("div",{staticClass:"handbook__calendar-wrapper"},[a("label",{staticClass:"dropdown-label"},[t._v(" "+t._s(t.$t("startDate"))+" ")]),a("PCalendar",{staticClass:"handbook__calendar",attrs:{"date-format":"dd.mm.yy","select-other-months":!0},model:{value:e.start_date,callback:function(a){t.$set(e,"start_date",a)},expression:"status.start_date"}}),a("label",{staticClass:"required-label"},[t._v(" "+t._s(t.$t("requiredField"))+" ")])],1),a("div",{staticClass:"handbook__calendar-wrapper"},[a("label",{staticClass:"dropdown-label"},[t._v(" "+t._s(t.$t("endDate"))+" ")]),a("PCalendar",{staticClass:"handbook__calendar",attrs:{"date-format":"dd.mm.yy","select-other-months":!0,placeholder:"__.__.____"},model:{value:e.end_date,callback:function(a){t.$set(e,"end_date",a)},expression:"status.end_date"}}),a("label",{staticClass:"required-label"},[t._v(" "+t._s(t.$t("notRequiredField"))+" ")])],1)])],1)})),t.isShowOnly?t._e():a("Icon",{attrs:{name:"circlePlus"},on:{click:t.addDefaultStatus}})]},proxy:!0},t.isShowOnly?null:{key:"footer",fn:function(){return[a("div",{staticClass:"modal-window__footer"},[a("PButton",{staticClass:"modal-window__footer-button p-button-help p-button-outlined",attrs:{label:t.$t("cancel")},on:{click:t.closePopup}}),a("PButton",{staticClass:"modal-window__footer-button",class:t.buttonClasses,attrs:{label:t.$t("save")},on:{click:t.save}})],1)]},proxy:!0}],null,!0)}):t._e()],2)},n=[],r=a("5530"),o=a("1da1"),i=a("2909"),u=(a("96cf"),a("d3b7"),a("3ca3"),a("ddb0"),a("caad"),a("2532"),a("4de4"),a("99af"),a("d81d"),a("b0c0"),a("7db0"),a("159b"),a("f97a")),d=a.n(u),c=a("c828"),l=a("ce93"),m=function(){return Promise.resolve().then(a.bind(null,"d010"))},_=function(){return Promise.resolve().then(a.bind(null,"77c0"))},f=function(){return a.e("chunk-50c3a4b7").then(a.bind(null,"a534"))},p=function(){return a.e("chunk-df75ff0e").then(a.t.bind(null,"63bb",7))},h=function(){return Promise.all([a.e("chunk-ad942926"),a.e("chunk-3bd5dade")]).then(a.t.bind(null,"9960",7))},b=function(){return Promise.resolve().then(a.bind(null,"83f8"))},v=function(){return a.e("chunk-06849146").then(a.bind(null,"209d"))},y={name:"Handbook",components:{Icon:m,ModalWindow:f,Avatar:_,PDropdown:p,PCalendar:h,PButton:d.a,Spinner:b,AcceptPopup:v},props:{userEducationForm:{type:Object,default:null},statuses:{type:Array,required:!0},user:{type:Object,default:null},isReadOnly:{type:Boolean,default:!1},statusLabel:{type:String,default:"name"}},data:function(){return{isOpenPopup:!1,isLoading:!1,allUserForms:[],allUserStatuses:[],statusToDelete:{status:null,title:"",actionLabel:""},educationFormsError:{value:!1,messages:{errorInEducationForms:this.$t("errors.educationForms"),noEducationForm:this.$t("errors.noEducationForm")}},statusesToAdd:[],statusesToEdit:[],statusesError:{value:!1,message:this.$t("errors.status")},temporaryStatuses:[]}},computed:{curatorGroups:function(){return this.$store.getters.curatorGroups},isEditable:function(){return!this.isReadOnly&&this.$store.getters.rolePermissions.includes("edit_user_form_and_statuses")},currentUser:function(){return this.$store.getters.user},isShowOnly:function(){var t=this;return!this.isEditable&&(!(!this.currentUser.is_parent||!this.currentUser.children.filter((function(e){return e.id===t.user.id})).length)||(!(!this.currentUser.groups_count||this.currentUser.id!==this.user.id)||(!!this.currentUser.subjects_count||!!Object(l["a"])(this.curatorGroups,this.user.id))))},isCanAddEducationForm:function(){return!this.isShowOnly&&(this.userEducationForm,!0)},isValidStatuses:function(){return!this.statusesError.value||!this.wrongStatuses.length},buttonClasses:function(){return!this.educationFormsError.value&&this.isValidStatuses?"p-button-help":"p-button-secondary"},wrongStatuses:function(){var t=this;return[].concat(Object(i["a"])(this.allUserStatuses),Object(i["a"])(this.statusesToAdd)).filter((function(e){var a;return!e.id||!e.start_date||t.$moment(e.start_date).isAfter(null!==(a=e.end_date)&&void 0!==a?a:"9999-12-31")}))}},methods:{userFullName:c["a"],normalizeDate:function(t){return this.$moment(t).format("DD.MM.YYYY HH:mm")},normalizeStartDate:function(t){return this.$moment.utc(t,"YYYY-MM-DD").isSame(this.$moment.utc("0001-01-01"))?null:new Date(this.$moment.utc(t,"YYYY-MM-DD"))},normalizeEndDate:function(t){return this.$moment.utc(t,"YYYY-MM-DD").isSame(this.$moment.utc("9999-12-31"))?null:new Date(this.$moment.utc(t,"YYYY-MM-DD"))},sortStatutes:function(t,e){return this.$moment(t.start_date).isAfter(this.$moment(e.start_date))?-1:1},sortEducationForms:function(t,e){return this.$moment(t.start_date).isAfter(this.$moment(e.start_date))?1:-1},openPopup:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isOpenPopup=!0,t.isLoading=!0,!1!==t.isShowOnly){e.next=7;break}return e.next=5,t.fetchEducationForms();case 5:return e.next=7,t.fetchTemporaryStatuses();case 7:return e.next=9,t.fetchAllUserEducationForms();case 9:return e.next=11,t.fetchAllUserStatuses();case 11:t.isLoading=!1;case 12:case"end":return e.stop()}}),e)})))()},fetchEducationForms:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$store.dispatch("selections/fetchEducationForms");case 3:a=e.sent,!a.success&&t.$notify({type:"error",text:a.message}),t.educationForms=a.data,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$notify({type:"error",text:t.$t("notifications.anyError")});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},fetchTemporaryStatuses:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$store.dispatch("selections/fetchTemporaryStatuses");case 3:a=e.sent,!a.success&&t.$notify({type:"error",text:a.message}),t.temporaryStatuses=a.data,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$notify({type:"error",text:t.$t("notifications.anyError")});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},fetchAllUserEducationForms:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$store.dispatch("handbook/fetchAllUserEducationForms",{user_id:t.user.id});case 3:a=e.sent,!a.success&&t.$notify({type:"error",text:a.message}),a.success&&(t.allUserForms=a.data.map((function(e){return Object(r["a"])(Object(r["a"])({},e),{},{start_date:t.normalizeStartDate(e.start_date),end_date:t.normalizeEndDate(e.end_date)})}))),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$notify({type:"error",text:t.$t("notifications.anyError")});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},fetchAllUserStatuses:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$store.dispatch("handbook/fetchAllUserStatuses",{user_id:t.user.id});case 3:a=e.sent,!a.success&&t.$notify({type:"error",text:a.message}),a.success&&(t.allUserStatuses=a.data.map((function(e){return Object(r["a"])(Object(r["a"])({},e),{},{start_date:t.normalizeStartDate(e.start_date),end_date:t.normalizeEndDate(e.end_date)})}))),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$notify({type:"error",text:t.$t("notifications.anyError")});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},confirmDeleteUserStatus:function(t){this.statusToDelete.status=t,this.statusToDelete.title=this.$t("confirm.title",{status:t.status.name}),this.statusToDelete.actionLabel=this.$t("confirm.actionLabel")},closeConfirmModal:function(){this.statusToDelete.status=null,this.statusToDelete.title="",this.statusToDelete.actionLabel=""},closePopup:function(){this.isOpenPopup=!1},addEducationForm:function(){this.allUserForms=[].concat(Object(i["a"])(this.allUserForms),[{id:-Math.random(),education_form_id:null,start_date:null,end_date:null}])},removeEducationForm:function(t){this.allUserForms=this.allUserForms.filter((function(e){return e.id!==t}))},addStatusToEdit:function(t){this.statusesToEdit=[].concat(Object(i["a"])(this.statusesToEdit),[Object(r["a"])({},t)])},removeStatusFromEdit:function(t){var e=this.statusesToEdit.find((function(e){return e.id===t.id}));this.allUserStatuses=this.allUserStatuses.map((function(t){return t.id===e.id?e:t})),this.statusesToEdit=this.statusesToEdit.filter((function(e){return e.id!==t.id}))},addDefaultStatus:function(){this.statusesToAdd=[].concat(Object(i["a"])(this.statusesToAdd),[{number:-Math.random(),id:null,start_date:null,end_date:null}])},removeStatusToAdd:function(t){this.statusesToAdd=this.statusesToAdd.filter((function(e,a){return t!==a}))},save:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.allUserForms.length&&t.checkValidationEducationForms()&&t.checkCrossEducationForms()&&t.checkEducationFormsDates())){e.next=7;break}return t.educationFormsError.value=!1,t.isLoading=!0,e.next=5,t.saveEducationForms();case 5:e.next=9;break;case 7:t.educationFormsError.value=!0,t.$notify({type:"error",text:t.educationFormsError.messages[t.allUserForms.length?"errorInEducationForms":"noEducationForm"]});case 9:if(!t.checkValidationUserStatuses()){e.next=19;break}if(t.isLoading=!0,e.t0=t.statusesToEdit.length,!e.t0){e.next=15;break}return e.next=15,t.updateUserStatuses();case 15:if(e.t1=t.statusesToAdd.length,!e.t1){e.next=19;break}return e.next=19,t.postUserStatuses();case 19:t.isLoading=!1;case 20:case"end":return e.stop()}}),e)})))()},checkEducationFormsDates:function(){var t=this,e=this.allUserForms.map((function(e){return Object(r["a"])(Object(r["a"])({},e),{},{start_date:e.start_date?t.$moment.utc(e.start_date):t.$moment("0001-01-01"),end_date:e.end_date?t.$moment.utc(e.end_date):t.$moment("9999-12-31")})})).sort(this.sortEducationForms);if(!e[0].start_date.isSame("0001-01-01"))return!1;if(!e[e.length-1].end_date.isSame("9999-12-31"))return!1;var a=this.$moment("9999-12-31").diff(this.$moment("0001-01-01"),"days")+1;return e.forEach((function(t){var e=t.end_date.diff(t.start_date,"days")+1;a-=e})),a-(e.length-1)===0},checkValidationEducationForms:function(){return this.allUserForms.every((function(t){return t.education_form_id}))},checkCrossEducationForms:function(){for(var t=this,e=this.allUserForms.map((function(e){return Object(r["a"])(Object(r["a"])({},e),{},{start_date:e.start_date?t.$moment(e.start_date):t.$moment("0001-01-01"),end_date:e.end_date?t.$moment(e.end_date):t.$moment("9999-12-31")})})).sort(this.sortEducationForms),a=0;a<e.length-1;++a)if(e[a].end_date.isSameOrAfter(e[a+1].start_date))return!1;return!0},checkValidationUserStatuses:function(){return this.wrongStatuses.length?(this.statusesError.value=!0,this.$notify({type:"error",text:this.statusesError.message}),!1):(this.statusesError.value=!1,!0)},saveEducationForms:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=t.allUserForms.map((function(e){return{id:e.id>0?e.id:void 0,form_id:e.education_form_id,start_date:e.start_date?t.$moment(e.start_date).format("YYYY-MM-DD"):null,end_date:e.end_date?t.$moment(e.end_date).format("YYYY-MM-DD"):null}})),e.next=4,t.$store.dispatch("handbook/updateUserEducationForms",{user_id:t.user.id,forms:a});case 4:s=e.sent,t.$notify({type:s.success?"success":"error",text:s.message}),s.success&&(t.allUserForms=s.data.map((function(e){return Object(r["a"])(Object(r["a"])({},e),{},{start_date:t.normalizeStartDate(e.start_date),end_date:t.normalizeEndDate(e.end_date)})})),n=s.data.find((function(e){return t.$moment().isBetween(e.start_date,e.end_date)})),t.$emit("updateEducationForm",n)),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),t.$notify({type:"error",text:t.$t("notifications.anyError")});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},updateUserStatuses:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(t.statusesToEdit.map((function(e){return t.allUserStatuses.find((function(t){return t.id===e.id}))})).map((function(e){return t.$store.dispatch("handbook/updateUserStatus",{id:e.id,status_id:e.temporary_status_id,user_id:e.user_id,start_date:t.$moment(e.start_date).format("YYYY-MM-DD"),end_date:e.end_date?t.$moment(e.end_date).format("YYYY-MM-DD"):"9999-12-31"})})));case 3:a=e.sent,s=a.find((function(t){return!t.success})),t.$notify({type:s?"error":"success",text:s?s.message:a[0].message}),t.allUserStatuses=t.allUserStatuses.map((function(e){var s=a.filter((function(t){return t.success})).map((function(t){return t.data})).find((function(t){return t.id===e.id}));return s?Object(r["a"])(Object(r["a"])({},s),{},{start_date:t.normalizeStartDate(s.start_date),end_date:t.normalizeEndDate(s.end_date)}):e})).sort(t.sortStatutes),t.statusesToEdit=[],t.$emit("updateUserStatuses",t.allUserStatuses),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),t.$notify({type:"error",text:t.$t("notifications.anyError")});case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()},postUserStatuses:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(t.statusesToAdd.map((function(e){return t.$store.dispatch("handbook/addStatusToUser",{status_id:e.id,user_id:t.user.id,start_date:t.$moment(e.start_date).format("YYYY-MM-DD"),end_date:e.end_date?t.$moment(e.end_date).format("YYYY-MM-DD"):void 0})})));case 3:a=e.sent,s=a.find((function(t){return!t.success})),t.$notify({type:s?"error":"success",text:s?s.message:a[0].message}),t.allUserStatuses=[].concat(Object(i["a"])(t.allUserStatuses),Object(i["a"])(a.filter((function(t){return t.success})).map((function(t){return t.data})).map((function(e){return Object(r["a"])(Object(r["a"])({},e),{},{start_date:t.normalizeStartDate(e.start_date),end_date:t.normalizeEndDate(e.end_date)})})))).sort(t.sortStatutes),t.statusesToAdd=[],t.$emit("updateUserStatuses",t.allUserStatuses),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),t.$notify({type:"error",text:t.$t("notifications.anyError")});case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()},deleteUserStatus:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a=Object(r["a"])({},t.statusToDelete.status),e.next=4,t.$store.dispatch("handbook/deleteUserStatus",{id:a.id});case 4:s=e.sent,t.$notify({type:s.success?"success":"error",text:s.message}),t.allUserStatuses=t.allUserStatuses.filter((function(t){return t.id!==a.id})),t.$emit("updateUserStatuses",t.allUserStatuses),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),t.$notify({type:"error",text:t.$t("notifications.anyError")});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()}}},k=y,$=(a("34ab"),a("2877")),g=a("b854"),S=Object($["a"])(k,s,n,!1,null,"0979bda6",null);"function"===typeof g["default"]&&Object(g["default"])(S);e["default"]=S.exports},ad04:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"ru":{"title":"Управление формами обучения","educationForm":"Постоянные формы обучения","educationFormTitle":"Название формы обучения","temporaryStatus":"Временные формы обучения","temporaryStatusTitle":"Название формы обучения","requiredField":"*Обязательное поле","notRequiredField":"Не обязательное поле","startDate":"Дата начала","endDate":"Дата конца","fillAllFields":"Заполните все поля","errors":{"educationForms":"Неправильно заполнена одна или несколько форм обучения","noEducationForm":"Форма обучения не выбрана","status":"Неправильно заполнен один или несколько статусов"},"confirm":{"title":"Вы действительно хотите удалить временный статус \\"{status}\\"","actionLabel":"Удалить"}}}'),delete t.options._Ctor}},b854:function(t,e,a){"use strict";var s=a("ad04"),n=a.n(s);e["default"]=n.a},c3a9:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",t._g({directives:[{name:"ripple",rawName:"v-ripple"}],class:t.buttonClass,attrs:{type:"button"}},t.$listeners),[t._t("default",[t.icon?a("span",{class:t.iconClass}):t._e(),a("span",{staticClass:"p-button-label"},[t._v(t._s(t.label||" "))]),t.badge?a("span",{staticClass:"p-badge",class:t.badgeStyleClass},[t._v(t._s(t.badge))]):t._e()])],2)},n=[],r=a("15f1"),o=a.n(r),i={props:{label:{type:String},icon:{type:String},iconPos:{type:String,default:"left"},badge:{type:String},badgeClass:{type:String,default:null}},computed:{buttonClass:function(){return{"p-button p-component":!0,"p-button-icon-only":this.icon&&!this.label,"p-button-vertical":("top"===this.iconPos||"bottom"===this.iconPos)&&this.label,"p-disabled":this.disabled}},iconClass:function(){return[this.icon,"p-button-icon",{"p-button-icon-left":"left"===this.iconPos&&this.label,"p-button-icon-right":"right"===this.iconPos&&this.label,"p-button-icon-top":"top"===this.iconPos&&this.label,"p-button-icon-bottom":"bottom"===this.iconPos&&this.label}]},badgeStyleClass:function(){return["p-badge p-component",this.badgeClass,{"p-badge-no-gutter":this.badge&&1===String(this.badge).length}]}},directives:{ripple:o.a}},u=i,d=a("2877"),c=Object(d["a"])(u,s,n,!1,null,null,null);e["default"]=c.exports},f97a:function(t,e,a){"use strict";t.exports=a("c3a9")}}]);